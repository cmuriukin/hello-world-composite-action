name: SonarQube Analysis

description: |
  This composite action runs a SonarQube analysis on a project.

inputs:
  sonar-token:
    description: 'The SonarQube authentication token.'
    required: true
  project-key:
    description: 'The SonarQube project key.'
    required: true
  project-name:
    description: 'The SonarQube project name.'
    required: true
  project-version:
    description: 'The SonarQube project version.'
    required: true
  sources:
    description: 'The source code directory to be analyzed.'
    required: true

runs:
  using: "composite"
  steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: SonarQube Scan
      uses: sonarsource/sonarqube-scan-action@master
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
          SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
      env:
        INPUT_SONAR-TOKEN: ${{ inputs.sonar-token }}
        INPUT_PROJECT-KEY: ${{ inputs.project-key }}
        INPUT_PROJECT-NAME: ${{ inputs.project-name }}
        INPUT_PROJECT-VERSION: ${{ inputs.project-version }}
        INPUT_SOURCES: ${{ inputs.sources }}
